namespace IoT.Display

open IoT.Display.Graphics

module FontClass =
    let fontHeight = 14
    let charSpacing = 1
    let lineSpacing = 2
    let wordSpacing = 6

    let getCharData char = 
        match char with
        | ' ' -> [|0x00uy;  0x00uy;  0x00uy;  0x00uy;  0x00uy;  0x00uy;  0x00uy;  0x00uy|]
        | '!' -> [|0xFEuy;  0x05uy|]
        | '"' -> [|0x1Euy;  0x00uy;  0x00uy;  0x00uy;  0x1Euy;  0x00uy|]
        | '#' -> [|0x80uy;  0x00uy;  0x90uy;  0x07uy;  0xF0uy;  0x00uy;  0x9Euy;  0x07uy;  0xF0uy;  0x00uy;  0x9Euy;  0x00uy;  0x10uy;  0x00uy|]
        | '$' -> [|0x38uy;  0x02uy;  0x44uy;  0x04uy;  0xFEuy;  0x0Fuy;  0x44uy;  0x04uy;  0x98uy;  0x03uy|]
        | '%' -> [|0x0Cuy;  0x00uy;  0x12uy;  0x02uy;  0x12uy;  0x01uy;  0x8Cuy;  0x00uy;  0x40uy;  0x00uy;  0x20uy;  0x00uy;  0x10uy;  0x03uy;  0x88uy;  0x04uy;  0x84uy;  0x04uy;  0x00uy;  0x03uy|]
        | '&' -> [|0x80uy;  0x03uy;  0x5Cuy;  0x04uy;  0x22uy;  0x04uy;  0x62uy;  0x04uy;  0x9Cuy;  0x05uy;  0x00uy;  0x02uy;  0x00uy;  0x05uy|]
        | '\\' -> [|0x0Euy; 0x00uy; 0x70uy;  0x00uy;  0x80uy;  0x03uy;  0x00uy;  0x1Cuy; |]
        | '(' -> [|0xF0uy;  0x07uy;  0x0Cuy;  0x18uy;  0x02uy;  0x20uy|]
        | ')' -> [|0x02uy;  0x20uy;  0x0Cuy;  0x18uy;  0xF0uy;  0x07uy|]
        | '*' -> [|0x14uy;  0x00uy;  0x18uy;  0x00uy;  0x0Euy;  0x00uy;  0x18uy;  0x00uy;  0x14uy;  0x00uy|]
        | '+' -> [|0x40uy;  0x00uy;  0x40uy;  0x00uy;  0xF0uy;  0x01uy;  0x40uy;  0x00uy;  0x40uy;  0x00uy|]
        | ',' -> [|0x00uy;  0x08uy;  0x00uy;  0x04uy|]
        | '-' -> [|0x40uy;  0x00uy;  0x40uy;  0x00uy;  0x40uy;  0x00uy;  0x40uy;  0x00uy|]
        | '.' -> [|0x00uy;  0x04uy|]
        | '/' -> [|0x00uy;  0x1Cuy;  0x80uy;  0x03uy;  0x70uy;  0x00uy;  0x0Euy;  0x00uy|]
        | '0' -> [|0xFCuy;  0x03uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0xFCuy;  0x03uy|]
        | '1' -> [|0x04uy;  0x00uy;  0x04uy;  0x00uy;  0xFEuy;  0x07uy|]
        | '2' -> [|0x0Cuy;  0x07uy;  0x82uy;  0x04uy;  0x42uy;  0x04uy;  0x22uy;  0x04uy;  0x1Cuy;  0x04uy|]
        | '3' -> [|0x04uy;  0x02uy;  0x02uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0xDCuy;  0x03uy|]
        | '4' -> [|0xC0uy;  0x00uy;  0xA0uy;  0x00uy;  0x98uy;  0x00uy;  0x84uy;  0x00uy;  0xFEuy;  0x07uy|]
        | '5' -> [|0x7Euy;  0x02uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0xC2uy;  0x03uy|]
        | '6' -> [|0xFCuy;  0x03uy;  0x42uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0xC4uy;  0x03uy|]
        | '7' -> [|0x02uy;  0x00uy;  0x02uy;  0x07uy;  0xC2uy;  0x00uy;  0x32uy;  0x00uy;  0x0Euy;  0x00uy|]
        | '8' -> [|0xDCuy;  0x03uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0xDCuy;  0x03uy|]
        | '9' -> [|0x3Cuy;  0x02uy;  0x42uy;  0x04uy;  0x42uy;  0x04uy;  0x22uy;  0x04uy;  0xFCuy;  0x03uy|]
        | ':' -> [|0x10uy;  0x04uy|]
        | ';' -> [|0x00uy;  0x08uy;  0x10uy;  0x04uy|]
        | '<' -> [|0x40uy;  0x00uy;  0xE0uy;  0x00uy;  0xB0uy;  0x01uy;  0x18uy;  0x03uy;  0x08uy;  0x02uy|]
        | '=' -> [|0xA0uy;  0x00uy;  0xA0uy;  0x00uy;  0xA0uy;  0x00uy;  0xA0uy;  0x00uy;  0xA0uy;  0x00uy|]
        | '>' -> [|0x08uy;  0x02uy;  0x18uy;  0x03uy;  0xB0uy;  0x01uy;  0xE0uy;  0x00uy;  0x40uy;  0x00uy|]
        | '?' -> [|0x0Cuy;  0x00uy;  0x02uy;  0x00uy;  0xC2uy;  0x05uy;  0x22uy;  0x00uy;  0x1Cuy;  0x00uy|]
        | '@' -> [|0xF0uy;  0x00uy;  0x0Cuy;  0x03uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0xE1uy;  0x08uy;  0x11uy;  0x09uy;  0x11uy;  0x09uy;  0x91uy;  0x08uy;  0x72uy;  0x09uy;  0x02uy;  0x05uy;  0x0Cuy;  0x05uy;  0xF0uy;  0x00uy|]
        | 'A' -> [|0x00uy;  0x06uy;  0x80uy;  0x01uy;  0xE0uy;  0x00uy;  0x98uy;  0x00uy;  0x86uy;  0x00uy;  0x98uy;  0x00uy;  0xE0uy;  0x00uy;  0x80uy;  0x01uy;  0x00uy;  0x06uy|]
        | 'B' -> [|0xFEuy;  0x07uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0xDCuy;  0x03uy|]
        | 'C' -> [|0xF8uy;  0x01uy;  0x04uy;  0x02uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x04uy;  0x02uy;  0x08uy;  0x01uy|]
        | 'D' -> [|0xFEuy;  0x07uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x04uy;  0x02uy;  0xF8uy;  0x01uy|]
        | 'E' -> [|0xFEuy;  0x07uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x02uy;  0x04uy|]
        | 'F' -> [|0xFEuy;  0x07uy;  0x22uy;  0x00uy;  0x22uy;  0x00uy;  0x22uy;  0x00uy;  0x22uy;  0x00uy;  0x22uy;  0x00uy;  0x02uy;  0x00uy|]
        | 'G' -> [|0xF8uy;  0x01uy;  0x04uy;  0x02uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x42uy;  0x04uy;  0x44uy;  0x02uy;  0xC8uy;  0x07uy|]
        | 'H' -> [|0xFEuy;  0x07uy;  0x20uy;  0x00uy;  0x20uy;  0x00uy;  0x20uy;  0x00uy;  0x20uy;  0x00uy;  0x20uy;  0x00uy;  0x20uy;  0x00uy;  0xFEuy;  0x07uy|]
        | 'I' -> [|0xFEuy;  0x07uy|]
        | 'J' -> [|0x00uy;  0x03uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy;  0xFEuy;  0x03uy|]
        | 'K' -> [|0xFEuy;  0x07uy;  0x20uy;  0x00uy;  0x50uy;  0x00uy;  0x88uy;  0x00uy;  0x04uy;  0x01uy;  0x02uy;  0x02uy;  0x00uy;  0x04uy|]
        | 'L' -> [|0xFEuy;  0x07uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy|]
        | 'M' -> [|0xFEuy;  0x07uy;  0x18uy;  0x00uy;  0x60uy;  0x00uy;  0x80uy;  0x01uy;  0x00uy;  0x06uy;  0x80uy;  0x01uy;  0x60uy;  0x00uy;  0x18uy;  0x00uy;  0xFEuy;  0x07uy|]
        | 'N' -> [|0xFEuy;  0x07uy;  0x04uy;  0x00uy;  0x18uy;  0x00uy;  0x20uy;  0x00uy;  0x40uy;  0x00uy;  0x80uy;  0x01uy;  0x00uy;  0x02uy;  0xFEuy;  0x07uy|]
        | 'O' -> [|0xF8uy;  0x01uy;  0x04uy;  0x02uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x04uy;  0x02uy;  0xF8uy;  0x01uy|]
        | 'P' -> [|0xFEuy;  0x07uy;  0x42uy;  0x00uy;  0x42uy;  0x00uy;  0x42uy;  0x00uy;  0x42uy;  0x00uy;  0x42uy;  0x00uy;  0x24uy;  0x00uy;  0x18uy;  0x00uy|]
        | 'Q' -> [|0xF8uy;  0x01uy;  0x04uy;  0x02uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x04uy;  0x02uy;  0x05uy;  0x04uy;  0x02uy;  0xF8uy;  0x05uy|]
        | 'R' -> [|0xFEuy;  0x07uy;  0x42uy;  0x00uy;  0x42uy;  0x00uy;  0x42uy;  0x00uy;  0x42uy;  0x00uy;  0x42uy;  0x00uy;  0x64uy;  0x00uy;  0x98uy;  0x03uy;  0x00uy;  0x04uy|]
        | 'S' -> [|0x1Cuy;  0x03uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x22uy;  0x04uy;  0x42uy;  0x04uy;  0x42uy;  0x04uy;  0x8Cuy;  0x03uy|]
        | 'T' -> [|0x02uy;  0x00uy;  0x02uy;  0x00uy;  0x02uy;  0x00uy;  0x02uy;  0x00uy;  0xFEuy;  0x07uy;  0x02uy;  0x00uy;  0x02uy;  0x00uy;  0x02uy;  0x00uy;  0x02uy;  0x00uy|]
        | 'U' -> [|0xFEuy;  0x01uy;  0x00uy;  0x02uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy;  0x00uy;  0x02uy;  0xFEuy;  0x01uy|]
        | 'V' -> [|0x06uy;  0x00uy;  0x18uy;  0x00uy;  0x60uy;  0x00uy;  0x80uy;  0x01uy;  0x00uy;  0x06uy;  0x80uy;  0x01uy;  0x60uy;  0x00uy;  0x18uy;  0x00uy;  0x06uy;  0x00uy|]
        | 'W' -> [|0x0Euy;  0x00uy;  0x30uy;  0x00uy;  0xC0uy;  0x01uy;  0x00uy;  0x06uy;  0xC0uy;  0x01uy;  0x30uy;  0x00uy;  0x0Euy;  0x00uy;  0x30uy;  0x00uy;  0xC0uy;  0x01uy;  0x00uy;  0x06uy;  0xC0uy;  0x01uy;  0x30uy;  0x00uy;  0x0Euy;  0x00uy|]
        | 'X' -> [|0x06uy;  0x06uy;  0x08uy;  0x01uy;  0x90uy;  0x00uy;  0x60uy;  0x00uy;  0x60uy;  0x00uy;  0x90uy;  0x00uy;  0x08uy;  0x01uy;  0x06uy;  0x06uy|]
        | 'Y' -> [|0x06uy;  0x00uy;  0x08uy;  0x00uy;  0x10uy;  0x00uy;  0x20uy;  0x00uy;  0xC0uy;  0x07uy;  0x20uy;  0x00uy;  0x10uy;  0x00uy;  0x08uy;  0x00uy;  0x06uy;  0x00uy|]
        | 'Z' -> [|0x02uy;  0x06uy;  0x82uy;  0x05uy;  0x42uy;  0x04uy;  0x22uy;  0x04uy;  0x1Auy;  0x04uy;  0x06uy;  0x04uy|]
        | '[' -> [|0xFEuy;  0x3Fuy;  0x02uy;  0x20uy;  0x02uy;  0x20uy|]
        | ']' -> [|0x0Euy;  0x00uy;  0x70uy;  0x00uy;  0x80uy;  0x03uy;  0x00uy;  0x1Cuy|]
        | '^' -> [|0x02uy;  0x20uy;  0x02uy;  0x20uy;  0xFEuy;  0x3Fuy|]
        | '_' -> [|0x00uy;  0x10uy;  0x00uy;  0x10uy;  0x00uy;  0x10uy;  0x00uy;  0x10uy;  0x00uy;  0x10uy;  0x00uy;  0x10uy;  0x00uy;  0x10uy|]
        | '`' -> [|0x02uy;  0x00uy;  0x04uy;  0x00uy|]
        | 'a' -> [|0xA0uy;  0x03uy;  0x50uy;  0x04uy;  0x50uy;  0x04uy;  0x50uy;  0x04uy;  0x50uy;  0x04uy;  0xE0uy;  0x03uy;  0x00uy;  0x04uy|]
        | 'b' -> [|0xFEuy;  0x07uy;  0x20uy;  0x02uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0xE0uy;  0x03uy|]
        | 'c' -> [|0xE0uy;  0x03uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x20uy;  0x02uy|]
        | 'd' -> [|0xE0uy;  0x03uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x20uy;  0x02uy;  0xFEuy;  0x07uy|]
        | 'e' -> [|0xE0uy;  0x03uy;  0x90uy;  0x04uy;  0x90uy;  0x04uy;  0x90uy;  0x04uy;  0x90uy;  0x04uy;  0xE0uy;  0x02uy|]
        | 'f' -> [|0x10uy;  0x00uy;  0xFCuy;  0x07uy;  0x12uy;  0x00uy|]
        | 'g' -> [|0xE0uy;  0x03uy;  0x10uy;  0x24uy;  0x10uy;  0x24uy;  0x10uy;  0x24uy;  0x20uy;  0x22uy;  0xF0uy;  0x1Fuy|]
        | 'h' -> [|0xFEuy;  0x07uy;  0x20uy;  0x00uy;  0x10uy;  0x00uy;  0x10uy;  0x00uy;  0xE0uy;  0x07uy|]
        | 'i' -> [|0xF2uy;  0x07uy|]
        | 'j' -> [|0x00uy;  0x20uy;  0xF2uy;  0x1Fuy|]
        | 'k' -> [|0xFEuy;  0x07uy;  0x80uy;  0x00uy;  0xC0uy;  0x00uy;  0x20uy;  0x01uy;  0x10uy;  0x02uy;  0x00uy;  0x04uy|]
        | 'l' -> [|0xFEuy;  0x07uy|]
        | 'm' -> [|0xF0uy;  0x07uy;  0x20uy;  0x00uy;  0x10uy;  0x00uy;  0x10uy;  0x00uy;  0xE0uy;  0x07uy;  0x20uy;  0x00uy;  0x10uy;  0x00uy;  0x10uy;  0x00uy;  0xE0uy;  0x07uy|]
        | 'n' -> [|0xF0uy;  0x07uy;  0x20uy;  0x00uy;  0x10uy;  0x00uy;  0x10uy;  0x00uy;  0xE0uy;  0x07uy|]
        | 'o' -> [|0xE0uy;  0x03uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0xE0uy;  0x03uy|]
        | 'p' -> [|0xF0uy;  0x3Fuy;  0x20uy;  0x02uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0xE0uy;  0x03uy|]
        | 'q' -> [|0xE0uy;  0x03uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x10uy;  0x04uy;  0x20uy;  0x02uy;  0xF0uy;  0x3Fuy|]
        | 'r' -> [|0xF0uy;  0x07uy;  0x20uy;  0x00uy;  0x10uy;  0x00uy|]
        | 's' -> [|0x60uy;  0x02uy;  0x90uy;  0x04uy;  0x90uy;  0x04uy;  0x90uy;  0x04uy;  0x20uy;  0x03uy|]
        | 't' -> [|0x10uy;  0x00uy;  0xFCuy;  0x03uy;  0x10uy;  0x04uy|]
        | 'u' -> [|0xF0uy;  0x03uy;  0x00uy;  0x04uy;  0x00uy;  0x04uy;  0x00uy;  0x02uy;  0xF0uy;  0x07uy|]
        | 'v' -> [|0x30uy;  0x00uy;  0xC0uy;  0x00uy;  0x00uy;  0x03uy;  0x00uy;  0x04uy;  0x00uy;  0x03uy;  0xC0uy;  0x00uy;  0x30uy;  0x00uy|]
        | 'w' -> [|0x30uy;  0x00uy;  0xC0uy;  0x01uy;  0x00uy;  0x06uy;  0xC0uy;  0x01uy;  0x30uy;  0x00uy;  0xC0uy;  0x01uy;  0x00uy;  0x06uy;  0xC0uy;  0x01uy;  0x30uy;  0x00uy|]
        | 'x' -> [|0x10uy;  0x04uy;  0x20uy;  0x02uy;  0xC0uy;  0x01uy;  0xC0uy;  0x01uy;  0x20uy;  0x02uy;  0x10uy;  0x04uy|]
        | 'y' -> [|0x30uy;  0x20uy;  0xC0uy;  0x20uy;  0x00uy;  0x13uy;  0x00uy;  0x0Cuy;  0x00uy;  0x03uy;  0xC0uy;  0x00uy;  0x30uy;  0x00uy|]
        | 'z' -> [|0x10uy;  0x06uy;  0x90uy;  0x05uy;  0x50uy;  0x04uy;  0x30uy;  0x04uy|]
        | '{' -> [|0x80uy;  0x00uy;  0x80uy;  0x00uy;  0x7Cuy;  0x1Fuy;  0x02uy;  0x20uy;  0x02uy;  0x20uy|]
        | '|' -> [|0xFEuy;  0x3Fuy|]
        | '}' -> [|0x02uy;  0x20uy;  0x02uy;  0x20uy;  0x7Cuy;  0x1Fuy;  0x80uy;  0x00uy;  0x80uy;  0x00uy|]
        | '~' -> [|0x0Cuy;  0x00uy;  0x02uy;  0x00uy;  0x02uy;  0x00uy;  0x04uy;  0x00uy;  0x08uy;  0x00uy;  0x08uy;  0x00uy;  0x06uy;  0x00uy|]
        | _ ->   [|0x0Cuy;  0x00uy;  0x02uy;  0x00uy;  0xC2uy;  0x05uy;  0x22uy;  0x00uy;  0x1Cuy;  0x00uy|]

    let getCharGraphics c = 
        let bytes = getCharData c
        let width = bytes.Length /2
        Graphics(AddressingMode.ColumnMajor, Little, {Width = width; Height = fontHeight}, bytes)